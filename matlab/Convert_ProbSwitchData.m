%BSD001_data = {load('A2A-15B-B_LT_20200316_ProbSwitch_FP_RH_p155.mat')};
clear all
%load('A2A-15B-B_RT_20200312_ProbSwitch_FP_RH_session1_p151.mat')
BSD002_data = {load('A2A-15B-B_RT_20200302_ProbSwitch_p141.mat'),load('A2A-15B-B_RT_20200303_ProbSwitch_p142.mat'),...
               load('A2A-15B-B_RT_20200304_ProbSwitch_p143.mat'),load('A2A-15B-B_RT_20200305_ProbSwitch_p144.mat'),...
               load('A2A-15B-B_RT_20200306_ProbSwitch_p145.mat'),load('A2A-15B-B_RT_20200307_ChR2-Switch-no-cue_p146.mat'),...
               load('A2A-15B-B_RT_20200308_ProbSwitch_p147.mat'),load('A2A-15B-B_RT_20200309_ProbSwitch_p148.mat'),...
               load('A2A-15B-B_RT_20200310_ProbSwitch_p149.mat'),load('A2A-15B-B_RT_20200311_ProbSwitch_p150.mat'),...
               load('A2A-15B-B_RT_20200312_ProbSwitch_FP_RH_session1_p151.mat'),load('A2A-15B-B_RT_20200312_ProbSwitch_FP_RH_session2_p151.mat'),...
               load('A2A-15B-B_RT_20200314_ProbSwitch_FP_LH_p153.mat'),load('A2A-15B-B_RT_20200315_ProbSwitch_p154.mat'),...
               load('A2A-15B-B_RT_20200316_ProbSwitch_p155.mat'),load('A2A-15B-B_RT_20200317_ProbSwitch_FP_RH_p156.mat'),...
               load('A2A-15B-B_RT_20200528_ProbSwitch_p228.mat'),...
               load('A2A-15B-B_RT_20200529_ProbSwitch_p229.mat'),load('A2A-15B-B_RT_20200530_ProbSwitch_p230.mat'),...
               load('A2A-15B-B_RT_20200531_ProbSwitch_p231.mat'),load('A2A-15B-B_RT_20200601_ProbSwitch_FP_RH_p232_allhist.mat'),...
               load('A2A-15B-B_RT_20200602_ProbSwitch_p233.mat'),load('A2A-15B-B_RT_20200603_ProbSwitch_p234.mat'),...
               load('A2A-15B-B_RT_20200604_ProbSwitch_FP_LH_p235_allhist.mat'),load('A2A-15B-B_RT_20200605_ProbSwitch_p236.mat')...
               load('A2A-15B-B_RT_20200606_ProbSwitch_p237.mat'),load('A2A-15B-B_RT_20200607_ProbSwitch_FP_LH_p238_allhist.mat'),...
               load('A2A-15B-B_RT_20200608_ProbSwitch_p239.mat'),load('A2A-15B-B_RT_20200609_ProbSwitch_p240.mat'),...
               load('A2A-15B-B_RT_20200610_ProbSwitch_p241.mat'),load('A2A-15B-B_RT_20200611_ProbSwitch_p242.mat'),...
               load('A2A-15B_RT_20200612_ProbSwitch_p243_FP_RH.mat'),...
               load('A2A-15B_RT_20200613_ProbSwitch_p244_FP_RH.mat'),load('A2A-15B_RT_20200614_ProbSwitch_p245.mat'),...
               load('A2A-15B_RT_20200615_ProbSwitch_p246.mat'),load('A2A-15B_RT_20200616_ProbSwitch_p247.mat'),...
               load('A2A-15B_RT_20200617_RH_ProbSwitch_p248_session1_FP_RH.mat'),load('A2A-15B_RT_20200617_RH_ProbSwitch_p248_session2_FP_RH.mat'),...
               load('A2A-15B_RT_20200618_ProbSwitch_p249.mat'),load('A2A-15B_RT_20200619_ProbSwitch_p250.mat'),...
               load('A2A-15B_RT_20200620_ProbSwitch_p251.mat'),load('A2A-15B_RT_20200621_LH_ProbSwitch_p252_FP_LH.mat'),...
               load('A2A-15B_RT_20200622_ProbSwitch_p253.mat'),load('A2A-15B_RT_20200623_ProbSwitch_p254.mat'),...
               load('A2A-15B_RT_20200624_ProbSwitch_p255.mat'),load('A2A-15B_RT_20200625_ProbSwitch_p256.mat'),...
               load('A2A-15B_RT_20200626_ProbSwitch_p257.mat'),load('A2A-15B_RT_20200628_ProbSwitch_p259.mat'),...
               load('A2A-15B_RT_20200629_ProbSwitch_p260.mat'),load('A2A-15B_RT_20200630_ProbSwitch_p261.mat'),...
               load('A2A-15B_RT_20200701_ProbSwitch_p262.mat'),load('A2A-15B_RT_20200702_ProbSwitch_p263.mat'),...
               load('A2A-15B_RT_20200703_ProbSwitch_p264.mat'),load('A2A-15B_RT_20200704_ProbSwitch_p265.mat'),...
               load('A2A-15B_RT_20200705_ProbSwitch_p266.mat'),load('A2A-15B_RT_20200706_ProbSwitch_p267.mat')};
            
                %load('A2A-15B-B_RT_20200526_ProbSwitch_p226.mat'),...
                %load('A2A-15B-B_RT_20200527_ProbSwitch_p227.mat')
           
           
BSD003_data = {load('A2A-16B-1_RT_20200315_ChR2_p145.mat'),load('A2A-16B-1_RT_20200316_ChR2_p146.mat'),...
               load('A2A-16B-1_RT_20200317_ChR2_FP_LH_p147.mat'),load('A2A-16B-1_RT_20200317_ChR2_FP_RH_p147.mat'),...
               load('A2A-16B-1_RT_20200528_ProbSwitch_p219.mat'),load('A2A-16B-1_RT_20200529_ProbSwitch_p220.mat'),...
               load('A2A-16B-1_RT_20200530_ProbSwitch_FP_RH_p221_allhist.mat'),load('A2A-16B-1_RT_20200531_ProbSwitch_p222.mat'),...
               load('A2A-16B-1_RT_20200601_ProbSwitch_p223.mat'),load('A2A-16B-1_RT_20200602_ProbSwitch_FP_LH_p224_allhist.mat'),...
               load('A2A-16B-1_RT_20200603_ProbSwitch_p225.mat'),load('A2A-16B-1_RT_20200604_ProbSwitch_p226.mat'),...
               load('A2A-16B-1_RT_20200605_ProbSwitch_FP_RH_p227_allhist.mat'),load('A2A-16B-1_RT_20200606_ProbSwitch_p228.mat'),...
               load('A2A-16B-1_RT_20200607_ProbSwitch_p229.mat'),load('A2A-16B-1_RT_20200608_ProbSwitch_p230.mat'),...
               load('A2A-16B-1_RT_20200609_ProbSwitch_FP_LH_p231_allhist.mat'),load('A2A-16B-1_RT_20200610_ProbSwitch_p232.mat'),...
               load('A2A-16B-1_RT_20200611_ProbSwitch_p233.mat'),load('A2A-16B_RT_20200612_ProbSwitch_p234.mat'),...
               load('A2A-16B_RT_20200613_ProbSwitch_p235.mat'),load('A2A-16B-1_RT_20200614_ProbSwitch_p236.mat'),...
               load('A2A-16B_RT_20200615_ProbSwitch_p237.mat'),load('A2A-16B_RT_20200616_ProbSwitch_p238_FP_RH.mat'),...
               load('A2A-16B_RT_20200617_ProbSwitch_p239.mat'),load('A2A-16B-1_RT_20200618_ProbSwitch_p240.mat'),...
               load('A2A-16B_RT_20200619_ProbSwitch_p241.mat'),load('A2A-16B_RT_20200620_ProbSwitch_p242_FP_LH.mat'),...
               load('A2A-16B_RT_20200621_ProbSwitch_p243.mat'),load('A2A-16B_RT_20200622_ProbSwitch_p244.mat'),...
               load('A2A-16B_RT_20200623_ProbSwitch_p245.mat'),load('A2A-16B_RT_20200624_ProbSwitch_p246_FP_RH_lots_miss_after_trial1100.mat'),...
               load('A2A-16B_RT_20200625_ProbSwitch_p247.mat'),load('A2A-16B_RT_20200626_ProbSwitch_p248.mat'),...
               load('A2A-16B_RT_20200627_ProbSwitch_p249_FP_LH.mat'),load('A2A-16B_RT_20200628_ProbSwitch_p250.mat'),...
               load('A2A-16B_RT_20200629_ProbSwitch_p251.mat'),load('A2A-16B_RT_20200630_ProbSwitch_p252.mat'),...
               load('A2A-16B_RT_20200701_ProbSwitch_p253.mat'),load('A2A-16B_RT_20200702_ProbSwitch_p254.mat'),...
               load('A2A-16B_RT_20200703_ProbSwitch_p255.mat'),load('A2A-16B_RT_20200704_ProbSwitch_p256_FP_RH.mat'),...
               load('A2A-16B_RT_20200705_ProbSwitch_p257.mat'),load('A2A-16B_RT_20200706_ProbSwitch_p258.mat')};

BSD004_data = {load('A2A-16B-1_TT_20200308_Probswitch_p138.mat'),load('A2A-16B-1_TT_20200309_ChR2-Switch-no-cue_p139.mat'),...
               load('A2A-16B-1_TT_20200310_ChR2-Switch-no-cue_p140.mat'),load('A2A-16B-1_TT_20200311_ChR2-Switch-no-cue_p141.mat'),...
               load('A2A-16B-1_TT_20200312_ChR2-Switch-no-cue_p142.mat'),load('A2A-16B-1_TT_20200314_ChR2-Switch-no-cue_p144.mat'),...
               load('A2A-16B-1_TT_20200315_ChR2-Switch-no-cue_FP_RH_p145_all_hist.mat'),load('A2A-16B-1_TT_20200316_ChR2-Switch-no-cue_FP_LH_p146.mat'),...
               load('A2A-16B-1_TT_20200317_ChR2-Switch-no-cue_p147.mat'),load('A2A-16B-1_TT_20200526_ProbSwitch_p217.mat'),...
               load('A2A-16B-1_TT_20200527_ProbSwitch_p218.mat'),load('A2A-16B-1_TT_20200528_ProbSwitch_p219.mat'),...
               load('A2A-16B-1_TT_20200529_ProbSwitch_FP_RH_p220.mat'),load('A2A-16B-1_TT_20200530_ProbSwitch_p221.mat'),...
               load('A2A-16B-1_TT_20200531_ProbSwitch_FP_LH_p222_allhist.mat'),load('A2A-16B-1_TT_20200601_ProbSwitch_p223.mat'),...
               load('A2A-16B-1_TT_20200602_ProbSwitch_p224.mat'),load('A2A-16B-1_TT_20200603_ProbSwitch_p225.mat'),...
               load('A2A-16B-1_TT_20200604_ProbSwitch_p226.mat'),load('A2A-16B-1_TT_20200605_ProbSwitch_p227.mat'),...
               load('A2A-16B-1_TT_20200606_ProbSwitch_p228.mat'),load('A2A-16B-1_TT_20200607_ProbSwitch_p229.mat'),...
               load('A2A-16B-1_TT_20200608_ProbSwitch_p230.mat'),load('A2A-16B-1_TT_20200609_ProbSwitch_p231.mat'),...
               load('A2A-16B-1_TT_20200610_ProbSwitch_p232_plug_LH.mat'),load('A2A-16B_TT_20200611_ProbSwitch_p233_FP_LH.mat'),...
               load('A2A-16B_TT_20200612_ProbSwitch_p234.mat'),load('A2A-16B_TT_20200613_ProbSwitch_p235.mat'),...
               load('A2A-16B-1_TT_20200614_ProbSwitch_p236.mat'),load('A2A-16B_TT_20200615_ProbSwitch_p237_FP_RH.mat'),...
               load('A2A-16B_TT_20200616_ProbSwitch_p238.mat'),load('A2A-16B_TT_20200617_ProbSwitch_p239.mat'),...
               load('A2A-16B-1_TT_20200618_ProbSwitch_p240.mat'),load('A2A-16B_TT_20200619_ProbSwitch_p241_FP_LH.mat'),...
               load('A2A-16B_TT_20200620_ProbSwitch_p242.mat'),load('A2A-16B_TT_20200621_ProbSwitch_p243.mat'),...
               load('A2A-16B_TT_20200622_ProbSwitch_p244.mat'),load('A2A-16B_TT_20200623_ProbSwitch_p245_FP_RH.mat'),...
               load('A2A-16B_TT_20200624_ProbSwitch_p246.mat'),load('A2A-16B_TT_20200625_ProbSwitch_p247_biasedL.mat'),...
               load('A2A-16B_TT_20200626_ProbSwitch_p248_FP_LH.mat'),load('A2A-16B_TT_20200627_ProbSwitch_p249.mat'),...
               load('A2A-16B_TT_20200628_ProbSwitch_p250.mat'),load('A2A-16B_TT_20200629_ProbSwitch_p251.mat'),...
               load('A2A-16B_TT_20200630_ProbSwitch_p252.mat'),load('A2A-16B_TT_20200701_ProbSwitch_p253.mat'),...
               load('A2A-16B_TT_20200702_ProbSwitch_p254.mat'),load('A2A-16B_TT_20200703_ProbSwitch_p255_FP_LH.mat'),...
               load('A2A-16B_TT_20200704_ProbSwitch_p256.mat'),load('A2A-16B_TT_20200705_ProbSwitch_p257.mat'),...
               load('A2A-16B_TT_20200706_ProbSwitch_p258.mat')};

%FIND BSD004 data for 20200313!!!!
           
BSD005_data = {load('D1-27H_LT_20200305_ProbSwitch_p94.mat'),load('D1-27H_LT_20200306_ChR2-Switch-no-cue_p95.mat'),...
               load('D1-27H_LT_20200307_ChR2-Switch-no-cue_p96.mat'),load('D1-27H_LT_20200308_ProbSwitch_p97.mat'),...
               load('D1-27H_LT_20200309_ProbSwitch_p98.mat'),load('D1-27H_LT_20200310_ProbSwitch_p99.mat'),...
               load('D1-27H_LT_20200311_ProbSwitch_p100.mat'),load('D1-27H_LT_20200312_ProbSwitch_p101.mat'),...
               load('D1-27H_LT_20200313_ProbSwitch_FP_LH_p102.mat'),load('D1-27H_LT_20200314_ProbSwitch_FP_RH_p103.mat'),...
               load('D1-27H_LT_20200315_ProbSwitch_FP_LH_p104.mat'),load('D1-27H_LT_20200316_ProbSwitch_FP_LH_p105.mat'),...
               load('D1-27H_LT_20200317_ProbSwitch_p106.mat'),load('D1-27H_LT_20200530_lProbSwitch_p180.mat'),...
               load('D1-27H_LT_20200531_lProbSwitch_p181.mat'),load('D1-27H_LT_20200601_lProbSwitch_p182.mat'),...
               load('D1-27H_LT_20200602_ProbSwitch_p183.mat'),load('D1-27H_LT_20200603_ProbSwitch_p184.mat'),...
               load('D1-27H_LT_20200604_ProbSwitch_p185.mat'),load('D1-27H_LT_20200605_ProbSwitch_p186.mat'),...
               load('D1-27H_LT_20200606_ProbSwitch_p187.mat'),load('D1-27H_LT_20200607_ProbSwitch_p188.mat'),...
               load('D1-27H_LT_20200608_ProbSwitch_FP_RH_p189_allhist.mat'),load('D1-27H_LT_20200609_ProbSwitch_p190.mat'),...
               load('D1-27H_LT_20200610_ProbSwitch_p191.mat'),load('D1-27H_LT_20200611_ProbSwitch_p192.mat'),...
               load('D1-27H_LT_20200612_ProbSwitch_p193.mat'),load('D1-27H_LT_20200613_ProbSwitch_p194.mat'),...
               load('D1-27H_LT_20200614_ProbSwitch_FP_LH_p195.mat'),load('D1-27H_LT_20200615_ProbSwitch_p196.mat'),...
               load('D1-27H_LT_20200616_ProbSwitch_p197.mat'),load('D1-27H_LT_20200617_ProbSwitch_p198.mat'),...
               load('D1-27H_LT_20200618_ProbSwitch_FP_RH_p199.mat'),load('D1-27H_LT_20200619_ProbSwitch_p200.mat'),...
               load('D1-27H_LT_20200620_ProbSwitch_p201.mat'),load('D1-27H_LT_20200621_ProbSwitch_p202.mat'),...
               load('D1-27H_LT_20200622_ProbSwitch_p203_FP_LH.mat'),load('D1-27H_LT_20200623_ProbSwitch_p204.mat'),...
               load('D1-27H_LT_20200624_ProbSwitch_p205.mat'),load('D1-27H_LT_20200625_ProbSwitch_p206_FP_RH.mat'),...
               load('D1-27H_LT_20200626_ProbSwitch_p207.mat'),load('D1-27H_LT_202006127_ProbSwitch_p208'),...
               load('D1-27H_LT_202006128_ProbSwitch_p209_FP_LH.mat'),load('D1-27H_LT_20200629_ProbSwitch_p210.mat'),...
               load('D1-27H_LT_20200630_ProbSwitch_p211.mat'),load('D1-27H_LT_20200701_ProbSwitch_p212.mat'),...
               load('D1-27H_LT_20200702_ProbSwitch_p213_biasedR_FP_LH.mat'),load('D1-27H_LT_20200703_ProbSwitch_p214.mat'),...
               load('D1-27H_LT_20200704_ProbSwitch_p215.mat'),load('D1-27H_LT_20200705_ProbSwitch_p216_trig3_FP_LH.mat'),...
               load('D1-27H_LT_20200706_ProbSwitch_p217.mat')};
           
BSD006_data = {load('A2A-19B_LT_20200613_ProbSwitch_p114.mat'),load('A2A-19B_LT_20200615_ProbSwitch_p116.mat'),...
               load('A2A-19B_LT_20200616_ProbSwitch_p117.mat'),load('A2A-19B_LT_20200617_ProbSwitch_p118.mat'),...
               load('A2A-19B_LT_20200618_ProbSwitch_p119.mat'),load('A2A-19B_LT_20200619_ProbSwitch_p120.mat'),...
               load('A2A-19B_LT_20200620_ProbSwitch_p121.mat'),load('A2A-19B_LT_20200621_ProbSwitch_p122.mat'),...
               load('A2A-19B_LT_20200622_ProbSwitch_p123.mat'),load('A2A-19B_LT_20200623_ProbSwitch_p124_biasedL.mat'),...
               load('A2A-19B_LT_20200624_ProbSwitch_p125.mat'),load('A2A-19B_LT_20200625_ProbSwitch_p126_biasedL.mat'),...
               load('A2A-19B_LT_20200626_ProbSwitch_p127.mat'),load('A2A-19B_LT_20200627_ProbSwitch_p128_biasedL_again.mat'),...
               load('A2A-19B_LT_20200628_ProbSwitch_p129.mat'),load('A2A-19B_LT_20200629_ProbSwitch_p130_biasedL.mat'),...
               load('A2A-19B_LT_20200630_ProbSwitch_p131_plugR_lessLH2O.mat'),load('A2A-19B_LT_20200701_ProbSwitch_p132.mat'),...
               load('A2A-19B_LT_20200702_ProbSwitch_p133.mat'),load('A2A-19B_LT_20200703_ProbSwitch_p134_BiasedL.mat'),...
               load('A2A-19B_LT_20200704_ProbSwitch_p135_biasedL.mat'),load('A2A-19B_LT_20200705_ProbSwitch_p136_biasedL.mat'),...
               load('A2A-19B_LT_20200706_ProbSwitch_p137_plugL.mat'),load('A2A-19B_LT_20200707_ProbSwitch_p138.mat'),...
               load('A2A-19B_LT_20200708_ProbSwitch_p139.mat'),load('A2A-19B_LT_20200709_ProbSwitch_p140_FP_LH.mat'),...
               load('A2A-19B_LT_20200710_ProbSwitch_p141.mat'),load('A2A-19B_LT_20200711_ProbSwitch_p142.mat'),...
               load('A2A-19B_LT_20200712_ProbSwitch_p143.mat'),load('A2A-19B_LT_20200713_ProbSwitch_p144_plugR_no_signal.mat'),...
               load('A2A-19B_LT_20200714_ProbSwitch_p145.mat'),load('A2A-19B_LT_20200715_ProbSwitch_p146.mat'),...
               load('A2A-19B_LT_20200716_ProbSwitch_p147.mat')};
           
BSD007_data = {load('A2A-19B_RT_20200613_ProbSwitch_p114.mat'),load('A2A-19B_RT_20200613_ProbSwitch_p115.mat'),...
               load('A2A-19B_RT_20200615_ProbSwitch_p116.mat'),load('A2A-19B_RT_20200616_ProbSwitch_p117.mat'),...
               load('A2A-19B_RT_20200617_ProbSwitch_p118.mat'),load('A2A-19B_RT_20200618_ProbSwitch_p119.mat'),...
               load('A2A-19B_RT_20200619_ProbSwitch_p120.mat'),load('A2A-19B_RT_20200620_ProbSwitch_p121.mat'),...
               load('A2A-19B_RT_20200621_ProbSwitch_p122.mat'),load('A2A-19B_RT_20200622_ProbSwitch_p123_biasedL.mat'),...
               load('A2A-19B_RT_20200623_ProbSwitch_p124_biasedR.mat'),load('A2A-19B_RT_20200624_ProbSwitch_p125_biasedR.mat'),...
               load('A2A-19B_RT_20200626_ProbSwitch_p127.mat'),load('A2A-19B_RT_20200627_ProbSwitch_p128.mat'),...
               load('A2A-19B_RT_20200628_ProbSwitch_p129_plugL.mat'),load('A2A-19B_RT_20200629_ProbSwitch_p130.mat'),...
               load('A2A-19B_RT_20200630_ProbSwitch_p131_plugR_biasR.mat'),load('A2A-19B_RT_20200701_ProbSwitch_p132.mat'),...
               load('A2A-19B_RT_20200702_ProbSwitch_p133.mat'),load('A2A-19B_RT_20200703_ProbSwitch_p134.mat'),...
               load('A2A-19B_RT_20200704_ProbSwitch_p135_plugL.mat'),load('A2A-19B_RT_20200705_ProbSwitch_p136.mat'),...
               load('A2A-19B_RT_20200706_ProbSwitch_p137.mat'),load('A2A-19B_RT_20200707_ProbSwitch_p138.mat'),...
               load('A2A-19B_RT_20200708_ProbSwitch_p139_FP_LH.mat'),load('A2A-19B_RT_20200709_ProbSwitch_p140.mat'),...
               load('A2A-19B_RT_20200710_ProbSwitch_p141.mat'),load('A2A-19B_RT_20200711_ProbSwitch_p142.mat'),...
               load('A2A-19B_RT_20200712_ProbSwitch_p143_FP_RH_no_signal.mat'),load('A2A-19B_RT_20200713_ProbSwitch_p144.mat'),...
               load('A2A-19B_RT_20200714_ProbSwitch_p145.mat'),load('A2A-19B_RT_20200715_ProbSwitch_p146.mat'),...
               load('A2A-19B_RT_20200716_ProbSwitch_p147.mat'),load('A2A-19B_RT_20200717_ProbSwitch_p148_FP_LH.mat')};
           
BSD008_data = {load('A2A-19B_RV_20200613_ProbSwitch_p114.mat'),load('A2A-19B_RV_20200615_ProbSwitch_p116.mat'),...
               load('A2A-19B_RV_20200616_ProbSwitch_p117.mat'),load('A2A-19B_RV_20200617_ProbSwitch_p118.mat'),...
               load('A2A-19B_RV_20200618_ProbSwitch_p119.mat'),load('A2A-19B_RV_20200619_ProbSwitch_p120.mat'),...
               load('A2A-19B_RV_20200620_ProbSwitch_p121.mat'),load('A2A-19B_RV_20200621_ProbSwitch_p122.mat'),...
               load('A2A-19B_RV_20200622_ProbSwitch_p123.mat'),load('A2A-19B_RV_20200623_ProbSwitch_p124.mat'),...
               load('A2A-19B_RV_20200624_ProbSwitch_p125.mat'),load('A2A-19B_RV_20200625_ProbSwitch_p126.mat'),...
               load('A2A-19B_RV_20200626_ProbSwitch_p127.mat'),load('A2A-19B_RV_20200627_ProbSwitch_p128.mat'),...
               load('A2A-19B_RV_20200628_ProbSwitch_p129.mat'),load('A2A-19B_RV_20200629_ProbSwitch_p130_plugL.mat'),...
               load('A2A-19B_RV_20200630_ProbSwitch_p131.mat'),load('A2A-19B_RV_20200701_ProbSwitch_p132_plugR.mat'),...
               load('A2A-19B_RV_20200702_ProbSwitch_p133.mat'),load('A2A-19B_RV_20200703_ProbSwitch_p134_plugL.mat'),...
               load('A2A-19B_RV_20200704_ProbSwitch_p135.mat'),load('A2A-19B_RV_20200705_ProbSwitch_p136.mat'),...
               load('A2A-19B_RV_20200706_ProbSwitch_p137.mat'),load('A2A-19B_RV_20200707_ProbSwitch_p138_FP_LH_no470.mat'),...
               load('A2A-19B_RV_20200708_ProbSwitch_p139.mat'),load('A2A-19B_RV_20200709_ProbSwitch_p140.mat'),...
               load('A2A-19B_RV_20200710_ProbSwitch_p141.mat'),load('A2A-19B_RV_20200711_ProbSwitch_p142_FP_RH.mat'),...
               load('A2A-19B_RV_20200712_ProbSwitch_p143.mat'),load('A2A-19B_RV_20200713_ProbSwitch_p144.mat'),...
               load('A2A-19B_RV_20200714_ProbSwitch_p145.mat'),load('A2A-19B_RV_20200715_ProbSwitch_p146.mat'),...
               load('A2A-19B_RV_20200716_ProbSwitch_p147_FP_LH.mat')};
           
BSD009_data = {load('D1-28B_LT_20200613_ProbSwitch_p112.mat'),load('D1-28B_LT_20200614_ProbSwitch_p113.mat'),...
               load('D1-28B_LT_20200615_ProbSwitch_p114.mat'),load('D1-28B_LT_20200616_ProbSwitch_p115.mat'),...
               load('D1-28B_LT_20200617_ProbSwitch_p116.mat'),load('D1-28B_LT_20200618_ProbSwitch_p118.mat'),...
               load('D1-28B_LT_20200619_ProbSwitch_p118.mat'),load('D1-28B_LT_20200620_ProbSwitch_p119.mat'),...
               load('D1-28B_LT_20200621_ProbSwitch_p120.mat'),load('D1-28B_LT_20200622_ProbSwitch_p121.mat'),...
               load('D1-28B_LT_20200623_ProbSwitch_p122.mat'),load('D1-28B_LT_20200624_ProbSwitch_p123.mat'),...
               load('D1-28B_LT_20200625_ProbSwitch_p124.mat'),load('D1-28B_LT_20200626_ProbSwitch_p125.mat'),...
               load('D1-28B_LT_20200627_ProbSwitch_p126.mat'),load('D1-28B-LT_20200628_ProbSwitch_p127.mat'),...
               load('D1-28B_LT_20200629_ProbSwitch_p128_plugR.mat'),load('D1-28B_LT_20200630_ProbSwitch_p129.mat'),...
               load('D1-28B_LT_20200701_ProbSwitch_p130_plugL.mat'),load('D1-28B_LT_20200702_ProbSwitch_p131.mat'),...
               load('D1-28B_LT_20200703_ProbSwitch_p132.mat'),load('D1-28B_LT_20200704_ProbSwitch_p133.mat'),...
               load('D1-28B_LT_20200705_ProbSwitch_p134_plugR.mat'),load('D1-28B_LT_20200706_ProbSwitch_p135_FP_LH.mat'),...
               load('D1-28B_LT_20200706_ProbSwitch_p135_FP_LH_session2.mat'),load('D1-28B_LT_20200707_ProbSwitch_p136.mat'),...
               load('D1-28B_LT_20200708_ProbSwitch_p137.mat'),load('D1-28B_LT_20200709_ProbSwitch_p138.mat'),...
               load('D1-28B_LT_20200710_ProbSwitch_p140_560nm_only_470forSync_FP_RH.mat'),load('D1-28B_LT_20200711_ProbSwitch_p140.mat'),...
               load('D1-28B_LT_20200712_ProbSwitch_p141.mat'),load('D1-28B_LT_20200713_ProbSwitch_p142.mat'),...
               load('D1-28B_LT_20200714_ProbSwitch_p143.mat'),load('D1-28B_LT_20200715_ProbSwitch_p144_FP_LH.mat'),...
               load('D1-28B_LT_20200716_ProbSwitch_p145.mat')};
           
Animal_Behavior_Data = {BSD002_data,BSD003_data,BSD004_data,BSD005_data,BSD006_data,BSD007_data,BSD008_data,BSD009_data};

%Create empty variable
for i = 1:length(Animal_Behavior_Data)
    data(i).a = [];
    data(i).r = [];
    data(i).c = [];
    data(i).s = [];
end

for i = 1:length(Animal_Behavior_Data) %Loop through animals
    for j = 1:length(Animal_Behavior_Data{i}) %Loop through sessions of an animal
        behavior = Animal_Behavior_Data{i}{j};
        trials = behavior.exper.odor_2afc.param.countedtrial.value;
        rewarded = behavior.exper.odor_2afc.param.result.value;
        rewarded_portside = behavior.exper.odor_2afc.param.cue_port_side.value;
        chosenport=[];
        undocumented=[];
        %Remove unchosen trials
        rewarded = rewarded(1:trials);
        rewarded_portside = rewarded_portside(1:trials);
        
        no_choice_idx = find(rewarded==3|rewarded==4|rewarded==0);
        rewarded(no_choice_idx)=[];
        rewarded_portside(no_choice_idx)=[];
        outcomes = unique(rewarded);
        if sum(ismember(rewarded,0)) > 0
            if length(outcomes) > 4
                error('ughhhh')
            end
        else
            if length(outcomes) > 3
                error('ughhh')
            end
        end
        trials = trials-length(no_choice_idx);
        session = j*ones(1,trials);
        for k = 1:trials
            %Matrix of reward history at chosen port (only one can be nonzero at
            %each trial)
            %[L_rewarded R_rewarded L_unrewarded R_unrewarded]
            if rewarded_portside(k) == 1 && rewarded(k) == 1.2 
                chosenport(k) = 2; %right port
            elseif rewarded_portside(k) == 2 && rewarded(k) == 1.2
                chosenport(k) = 1; %left port
            elseif rewarded_portside(k) == 1 && rewarded(k) == 2 
                chosenport(k) = 1; %left port
            elseif rewarded_portside(k) == 1 && rewarded(k) == 1.1 
                chosenport(k) = 2; %right port
            elseif rewarded_portside(k) == 2 && rewarded(k) == 2
                chosenport(k) = 2; %right port
            elseif rewarded_portside(k) == 2 && rewarded(k) == 1.1
                chosenport(k) = 1; %left port
            else 
                undocumented = [undocumented; rewarded_portside(k), rewarded(k)];
            end
        end
        data(i).s = [data(i).s session];
        data(i).a = [data(i).a chosenport];
        omission_idx = find(rewarded==1.1);
        incorrect_idx = find(rewarded==2);
        reward_idx = find(rewarded==1.2);
        rewarded(omission_idx) = 0;
        rewarded(incorrect_idx) = 0;
        rewarded(reward_idx) = 1;
        if unique(rewarded) > 2
            error('try again friend!')
        end
        data(i).r = [data(i).r rewarded];
        cue_left_idx = find(rewarded_portside == 2);
        cue_right_idx = find(rewarded_portside == 1);
        rewarded_portside(cue_left_idx) = 1;
        rewarded_portside(cue_right_idx) = 2;
        data(i).c = [data(i).c rewarded_portside];
    end
end
pathname = fileparts('/Volumes/Christopher/Wilbrecht Lab/Belief State/');
savename = fullfile(pathname,'compiled_probswitch_data_07212020');
save(savename,'data')